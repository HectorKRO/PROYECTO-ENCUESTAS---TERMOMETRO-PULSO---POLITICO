-- ============================================================
-- V3.1: FIX ‚Äî Re-seed de colonias con municipio_id
-- ============================================================
-- Versi√≥n: v3.1 (Hotfix)
-- Fecha: 2026-02-28
--
-- PROBLEMA:
--   La tabla `colonias` est√° vac√≠a en producci√≥n (o tiene
--   municipio_id = NULL) porque el seed hist√≥rico
--   (seed_colonias_atlixco.sql) no inclu√≠a municipio_id,
--   y despu√©s de v3.0/01_catalogo_geografico.sql esa columna
--   qued√≥ NOT NULL ‚Äî haciendo imposible re-correr el seed.
--
-- S√çNTOMAS:
--   - "Selecciona una colonia (0 disponibles)" en FormularioEncuesta
--   - CACHE_VERSION bump invalid√≥ el cache del browser,
--     exponiendo que Supabase tiene 0 colonias activas.
--
-- SOLUCI√ìN:
--   1. Diagn√≥stico (mostrar estado actual)
--   2. Hacer municipio_id nullable temporalmente
--   3. Insertar las 417 colonias de Atlixco con ON CONFLICT DO NOTHING
--   4. Actualizar municipio_id v√≠a JOIN con secciones_electorales
--   5. Fallback: asignar municipio_id = 1 (Atlixco) para cualquier
--      colonia que no haya matcheado (defensivo)
--   6. Re-agregar NOT NULL
--   7. Validaci√≥n final
--
-- EJECUTAR EN: Supabase SQL Editor
-- IDEMPOTENTE: S√≠ ‚Äî ON CONFLICT DO NOTHING, safe para re-ejecutar
-- ============================================================

-- ============================================================
-- PASO 0: DIAGN√ìSTICO (ver estado antes del fix)
-- ============================================================
DO $$
DECLARE
  v_total    INT;
  v_con_mun  INT;
  v_activas  INT;
BEGIN
  SELECT COUNT(*) INTO v_total   FROM colonias;
  SELECT COUNT(*) INTO v_con_mun FROM colonias WHERE municipio_id = 1;
  SELECT COUNT(*) INTO v_activas FROM colonias WHERE municipio_id = 1 AND activa = true;

  RAISE NOTICE 'üìä DIAGN√ìSTICO COLONIAS:';
  RAISE NOTICE '   Total filas: %',                v_total;
  RAISE NOTICE '   Con municipio_id = 1 (Atlixco): %', v_con_mun;
  RAISE NOTICE '   Activas en Atlixco: %',         v_activas;

  IF v_activas >= 417 THEN
    RAISE NOTICE '‚úÖ Colonias ya est√°n correctamente sembradas. No se requiere acci√≥n.';
  ELSE
    RAISE NOTICE '‚ö†Ô∏è  Se proceder√° a sembrar las colonias faltantes...';
  END IF;
END $$;

-- ============================================================
-- PASO 1: HACER municipio_id NULLABLE TEMPORALMENTE
-- ============================================================
ALTER TABLE colonias ALTER COLUMN municipio_id DROP NOT NULL;

-- ============================================================
-- PASO 2: INSERTAR LAS 417 COLONIAS DE ATLIXCO
-- (ON CONFLICT DO NOTHING = idempotente)
-- ============================================================
INSERT INTO colonias (nombre, seccion_id, tipo, codigo_postal) VALUES
  ('ANTORCHA POPULAR CAMPESINA', '0154', 'COLONIA', '74360'),
  ('CUARTA SECCION', '0154', 'COLONIA', '74360'),
  ('IXTEPEC', '0154', 'FRACCIONAMIENTO', '74360'),
  ('LA JOYA', '0154', 'COLONIA', '74360'),
  ('LOMAS DEL FUERTE', '0154', 'COLONIA', '74360'),
  ('METEPEC', '0154', 'COLONIA', '74360'),
  ('QUINTA SECCION', '0154', 'COLONIA', '74360'),
  ('SEGUNDA SECCION', '0154', 'COLONIA', '74360'),
  ('SOLIDARIDAD METEPEC', '0154', 'COLONIA', '74360'),
  ('TERCERA SECCION', '0154', 'COLONIA', '74360'),
  ('METEPEC', '0155', 'COLONIA', '74360'),
  ('METEPEC', '0156', 'COLONIA', '74360'),
  ('6a SECCION', '0157', 'COLONIA', '74630'),
  ('ESMERALDA', '0157', 'RANCHO', '74630'),
  ('IXTEPEC', '0157', 'COLONIA', '74360'),
  ('METEPEC', '0157', 'COLONIA', '74360'),
  ('RANCHO EL RODEO', '0157', 'COLONIA', '74260'),
  ('SOLIDARIDAD METEPEC', '0157', 'COLONIA', '74360'),
  ('EL LEON', '0158', 'COLONIA', '74360'),
  ('EL LEON', '0158', 'FRACCIONAMIENTO', '74360'),
  ('ING CUAUHTEMOC CARDENAS (LA VILLA)', '0158', 'PUEBLO', '74360'),
  ('LOMAS DE ZARAGOZA (BORDE CERRO COLORADO)', '0158', 'COLONIA', '74360'),
  ('MARABU', '0158', 'COLONIA', '74360'),
  ('NUEVA GUELATAO', '0158', 'COLONIA', '74360'),
  ('RANCHO EL MEZQUITE', '0158', 'RANCHO', '74360'),
  ('SAN RAFAEL', '0158', 'COLONIA', '74360'),
  ('SOLIDARIDAD EL LEON', '0158', 'COLONIA', '74360'),
  ('VILLA LOMAS DE ZARAGOZA', '0158', 'COLONIA', '74360'),
  ('ZARAGOZA', '0158', 'COLONIA', '74360'),
  ('BENITO JUAREZ (PUEBLO VIEJO)', '0159', 'COLONIA', '74260'),
  ('EL FRAILE', '0159', 'COLONIA', '74260'),
  ('EL NANCE', '0159', 'COLONIA', '74260'),
  ('EL TEPETATE', '0159', 'COLONIA', '74260'),
  ('GUADALUPE', '0159', 'COLONIA', '74260'),
  ('HUERTAS FAMILIARES', '0159', 'COLONIA', '74260'),
  ('JARDINES DE ATLIXCO', '0159', 'FRACCIONAMIENTO', '74260'),
  ('LOMAS DE TEPATLAXCO', '0159', 'FRACCIONAMIENTO', '74260'),
  ('PRADOS DE ATLIXCO', '0159', 'FRACCIONAMIENTO', '74260'),
  ('SAN DIEGO', '0159', 'FRACCIONAMIENTO', '74260'),
  ('TEPATLAXCO', '0159', 'PUEBLO', '74260'),
  ('VISTA HERMOSA', '0159', 'FRACCIONAMIENTO', '74260'),
  ('AGUA AZUL', '0160', 'COLONIA', '74260'),
  ('ARBOLEDAS', '0160', 'FRACCIONAMIENTO', '74260'),
  ('BELEM', '0160', 'COLONIA', '74260'),
  ('BOSQUES DE AHUATEPEC', '0160', 'FRACCIONAMIENTO', '74260'),
  ('EL PORVENIR', '0160', 'FRACCIONAMIENTO', '74260'),
  ('EL RIEGO', '0160', 'COLONIA', '74260'),
  ('GRANJAS DE ATLIXCO', '0160', 'FRACCIONAMIENTO', '74260'),
  ('JESUS GARCIA', '0160', 'COLONIA', '74260'),
  ('LA PROVIDENCIA', '0160', 'COLONIA', '74260'),
  ('LAZARO CARDENAS', '0160', 'COLONIA', '74260'),
  ('LEONA VICARIO', '0160', 'COLONIA', '74260'),
  ('LOS LAVADEROS', '0160', 'COLONIA', '74260'),
  ('NICOLAS BRAVO', '0160', 'COLONIA', '74260'),
  ('NUEVA ESPERANZA', '0160', 'COLONIA', '74260'),
  ('PROLONGACION BELEM', '0160', 'COLONIA', '74260'),
  ('RESIDENCIAL EL ENCANTO', '0160', 'FRACCIONAMIENTO', '74260'),
  ('SAN ANTONIO', '0160', 'COLONIA', '74260'),
  ('SANTA ROSA', '0160', 'COLONIA', '74260'),
  ('SERAPIO RENDON', '0160', 'COLONIA', '74260'),
  ('TIERRA Y LIBERTAD', '0160', 'COLONIA', '74260'),
  ('VILLA ESMERALDA', '0160', 'COLONIA', '74260'),
  ('VILLA JARDIN', '0160', 'FRACCIONAMIENTO', '74260'),
  ('VISTA HERMOSA', '0160', 'COLONIA', '74260'),
  ('XOCHICUEITL', '0160', 'COLONIA', '74260'),
  ('AHUATLACO', '0161', 'PUEBLO', '74260'),
  ('BELEM', '0161', 'COLONIA', '74260'),
  ('BORDO CIPRESES', '0161', 'COLONIA', '74260'),
  ('EL PORTILLO', '0161', 'COLONIA', '74260'),
  ('JAVIER ROJO GOMEZ', '0161', 'COLONIA', '74260'),
  ('JOSE MARIA MORELOS', '0161', 'COLONIA', '74260'),
  ('LA LOMA', '0161', 'COLONIA', '74260'),
  ('MARAVILLAS SANTA ROSA', '0161', 'COLONIA', '74260'),
  ('MOLINO DE FLORES', '0161', 'COLONIA', '74260'),
  ('PARQUE INDUSTRIAL ATLIXCO', '0161', 'PARQUE INDUSTRIAL', '74260'),
  ('SAN ISIDRO', '0161', 'COLONIA', '74260'),
  ('SANTA ROSA', '0161', 'COLONIA', '74260'),
  ('VILLAS FONTANA', '0161', 'FRACCIONAMIENTO', '74260'),
  ('CENTRO', '0162', 'COLONIA', '74200'),
  ('BELEM', '0162', 'COLONIA', '74200'),
  ('DEL PARQUE', '0162', 'COLONIA', '74200'),
  ('EL MORAL', '0162', 'COLONIA', '74200'),
  ('EMILIO CARRANZA', '0162', 'COLONIA', '74200'),
  ('GUADALUPE', '0162', 'COLONIA', '74200'),
  ('INDEPENDENCIA', '0162', 'COLONIA', '74200'),
  ('LAS FUENTES', '0162', 'COLONIA', '74200'),
  ('MOCTEZUMA', '0162', 'COLONIA', '74200'),
  ('NUEVO CENTRO', '0162', 'COLONIA', '74200'),
  ('SAN MIGUEL', '0162', 'COLONIA', '74200'),
  ('SANTA CECILIA', '0162', 'COLONIA', '74200'),
  ('CENTRO', '0163', 'COLONIA', '74200'),
  ('EL CALVARIO', '0163', 'COLONIA', '74200'),
  ('INSURGENTES', '0163', 'COLONIA', '74200'),
  ('JARDIN', '0163', 'COLONIA', '74200'),
  ('LA CONCEPCION', '0163', 'COLONIA', '74200'),
  ('REFORMA', '0163', 'COLONIA', '74200'),
  ('SAN AGUSTIN', '0163', 'COLONIA', '74200'),
  ('SANTA CATARINA', '0163', 'COLONIA', '74200'),
  ('CENTRO', '0164', 'COLONIA', '74200'),
  ('ACOZAC', '0164', 'COLONIA', '74200'),
  ('BENITO JUAREZ', '0164', 'COLONIA', '74200'),
  ('EL CARMEN', '0164', 'COLONIA', '74200'),
  ('EMILIANO ZAPATA', '0164', 'COLONIA', '74200'),
  ('LA AURORA', '0164', 'COLONIA', '74200'),
  ('LA PROVIDENCIA', '0164', 'COLONIA', '74200'),
  ('LAS AM√âRICAS', '0164', 'COLONIA', '74200'),
  ('MAESTROS', '0164', 'COLONIA', '74200'),
  ('MIGUEL HIDALGO', '0164', 'COLONIA', '74200'),
  ('MORELOS', '0164', 'COLONIA', '74200'),
  ('NUEVO MEXICO', '0164', 'COLONIA', '74200'),
  ('OBRERA', '0164', 'COLONIA', '74200'),
  ('RAMOS MILLAN', '0164', 'COLONIA', '74200'),
  ('SAN ANTONIO', '0164', 'COLONIA', '74200'),
  ('SAN JUAN', '0164', 'COLONIA', '74200'),
  ('VENUSTIANO CARRANZA', '0164', 'COLONIA', '74200'),
  ('VICENTE GUERRERO', '0164', 'COLONIA', '74200'),
  ('ARROYO', '0165', 'COLONIA', '74200'),
  ('EL CARMEN', '0165', 'COLONIA', '74200'),
  ('EL ROSARIO', '0165', 'COLONIA', '74200'),
  ('EMILIANO ZAPATA', '0165', 'COLONIA', '74200'),
  ('JARDIN DE LAS ROSAS', '0165', 'COLONIA', '74200'),
  ('LA CONCEPCION', '0165', 'COLONIA', '74200'),
  ('LA LIBERTAD', '0165', 'COLONIA', '74200'),
  ('LAS MARAVILLAS', '0165', 'COLONIA', '74200'),
  ('LOS PINOS', '0165', 'COLONIA', '74200'),
  ('PROGRESO', '0165', 'COLONIA', '74200'),
  ('SAN ANTONIO', '0165', 'COLONIA', '74200'),
  ('VISTA HERMOSA', '0165', 'COLONIA', '74200'),
  ('EL CAMPANARIO', '0166', 'COLONIA', '74200'),
  ('EL CIPR√âS', '0166', 'COLONIA', '74200'),
  ('GUADALUPE', '0166', 'COLONIA', '74200'),
  ('LA JOYA', '0166', 'COLONIA', '74200'),
  ('LADERA NORTE', '0166', 'COLONIA', '74200'),
  ('LAS FLORES', '0166', 'COLONIA', '74200'),
  ('LOMAS DE GUADALUPE', '0166', 'COLONIA', '74200'),
  ('NUEVA SANTA ROSA', '0166', 'COLONIA', '74200'),
  ('SAN BERNABE', '0166', 'COLONIA', '74200'),
  ('SAN JOSE', '0166', 'COLONIA', '74200'),
  ('SAN MARTIN', '0166', 'COLONIA', '74200'),
  ('XOXOLOTZIN', '0166', 'COLONIA', '74200'),
  ('AQUILES SERDAN', '0167', 'COLONIA', '74200'),
  ('BUENOS AIRES', '0167', 'COLONIA', '74200'),
  ('EL ENCANTO', '0167', 'COLONIA', '74200'),
  ('LAS FLORES', '0167', 'COLONIA', '74200'),
  ('LOMAS ALTAS', '0167', 'COLONIA', '74200'),
  ('MONTECILLOS', '0167', 'COLONIA', '74200'),
  ('PRADOS', '0167', 'COLONIA', '74200'),
  ('SAN MARCOS', '0167', 'COLONIA', '74200'),
  ('SANTA CRUZ', '0167', 'COLONIA', '74200'),
  ('TEPEYAC', '0167', 'COLONIA', '74200'),
  ('VILLA LAS FLORES', '0167', 'COLONIA', '74200'),
  ('VILLAS DEL PEDREGAL', '0167', 'COLONIA', '74200'),
  ('ARBOLEDAS DE GUADALUPE', '0168', 'COLONIA', '74200'),
  ('EL CHICO', '0168', 'COLONIA', '74200'),
  ('EL PARED√ìN', '0168', 'COLONIA', '74200'),
  ('GUADALUPE', '0168', 'COLONIA', '74200'),
  ('LA CANTERA', '0168', 'COLONIA', '74200'),
  ('LOMAS DEL PEDREGAL', '0168', 'COLONIA', '74200'),
  ('PEDREGAL', '0168', 'COLONIA', '74200'),
  ('SANTA ISABEL', '0168', 'COLONIA', '74200'),
  ('VILLA GUADALUPE', '0168', 'COLONIA', '74200'),
  ('VILLA XANATH', '0168', 'COLONIA', '74200'),
  ('BELLO HORIZONTE', '0169', 'COLONIA', '74200'),
  ('EL SEMINARIO', '0169', 'COLONIA', '74200'),
  ('EMILIANO ZAPATA', '0169', 'COLONIA', '74200'),
  ('IGNACIO ZARAGOZA', '0169', 'COLONIA', '74200'),
  ('INDEPENDENCIA', '0169', 'COLONIA', '74200'),
  ('LA CANTERA', '0169', 'COLONIA', '74200'),
  ('LA LOMA', '0169', 'COLONIA', '74200'),
  ('LAS MA√ëANITAS', '0169', 'COLONIA', '74200'),
  ('MORELOS', '0169', 'COLONIA', '74200'),
  ('NUEVA INDEPENDENCIA', '0169', 'COLONIA', '74200'),
  ('NUEVO MILENIO', '0169', 'COLONIA', '74200'),
  ('PEDREGAL', '0169', 'COLONIA', '74200'),
  ('SAN JOSE ACATLAN', '0169', 'COLONIA', '74200'),
  ('SAN JOSE DEL PEDREGAL', '0169', 'COLONIA', '74200'),
  ('VISTA HERMOSA', '0169', 'COLONIA', '74200'),
  ('SANTA CATARINA ATLIXCO', '0169', 'PUEBLO', '74200'),
  ('AHUATEPEC', '0170', 'PUEBLO', '74260'),
  ('ACOZAC', '0170', 'COLONIA', '74260'),
  ('BENITO JUAREZ', '0170', 'COLONIA', '74260'),
  ('EL CARMEN', '0170', 'COLONIA', '74260'),
  ('LA CIENEGA', '0170', 'COLONIA', '74260'),
  ('LAS TORRES', '0170', 'COLONIA', '74260'),
  ('LOS ANGELES', '0170', 'COLONIA', '74260'),
  ('NUEVA INDEPENDENCIA', '0170', 'COLONIA', '74260'),
  ('SAN ANDRES ATLIXCO', '0170', 'PUEBLO', '74260'),
  ('SAN JOSE', '0170', 'COLONIA', '74260'),
  ('TEPEYAC', '0170', 'COLONIA', '74260'),
  ('XONACATEPEC', '0170', 'PUEBLO', '74260'),
  ('EL RINC√ìN', '0171', 'COLONIA', '74360'),
  ('GRANJAS UNIDAS', '0171', 'FRACCIONAMIENTO', '74360'),
  ('LA JOYA', '0171', 'COLONIA', '74360'),
  ('RANCHO EL RINC√ìN', '0171', 'RANCHO', '74360'),
  ('SAN MIGUEL TIANGUIZOLCO', '0171', 'PUEBLO', '74360'),
  ('SANTA MARIA ACTIPAN', '0171', 'PUEBLO', '74360'),
  ('TEXALPAN DE ABAJO', '0171', 'PUEBLO', '74360'),
  ('XOPANAC', '0171', 'COLONIA', '74360'),
  ('EL PERAL', '0172', 'COLONIA', '74360'),
  ('GRANJAS SAN MIGUEL', '0172', 'FRACCIONAMIENTO', '74360'),
  ('LAS PALOMAS', '0172', 'FRACCIONAMIENTO', '74360'),
  ('RANCHO LAS FLORES', '0172', 'RANCHO', '74360'),
  ('SAN MIGUEL TIANGUIZOLCO', '0172', 'PUEBLO', '74360'),
  ('SANTA ISABEL CHOLULA', '0172', 'PUEBLO', '74360'),
  ('VILLAS DEL PEDREGAL', '0172', 'FRACCIONAMIENTO', '74360'),
  ('EL TULAR', '0173', 'COLONIA', '74360'),
  ('RANCHO COYOMETL', '0173', 'RANCHO', '74360'),
  ('SAN BALTAZAR ATLIMEYAYA', '0173', 'PUEBLO', '74360'),
  ('SAN MARCOS ACTIPAN', '0173', 'PUEBLO', '74360'),
  ('SAN NICOLAS TOLENTINO', '0173', 'PUEBLO', '74360'),
  ('SANTA ROSA XOCHIAC', '0173', 'PUEBLO', '74360'),
  ('TEXALPAN DE ARRIBA', '0173', 'PUEBLO', '74360'),
  ('EL MOLINO', '0174', 'COLONIA', '74470'),
  ('LA ESPERANZA', '0174', 'COLONIA', '74470'),
  ('RINC√ìN DEL CIELO', '0174', 'COLONIA', '74470'),
  ('SAN ANDRES CALPAN', '0174', 'PUEBLO', '74470'),
  ('SAN MATEO OZOLCO', '0174', 'PUEBLO', '74470'),
  ('SAN NICOLAS HUAQUECHULA', '0174', 'PUEBLO', '74470'),
  ('TEJALPA', '0174', 'PUEBLO', '74470'),
  ('ACATL√ÅN', '0175', 'COLONIA', '74200'),
  ('CUESCOMATE', '0175', 'COLONIA', '74200'),
  ('EL COCO', '0175', 'COLONIA', '74200'),
  ('EL MIRADOR', '0175', 'COLONIA', '74200'),
  ('EL PARAISO', '0175', 'COLONIA', '74200'),
  ('EL RINC√ìN', '0175', 'COLONIA', '74200'),
  ('HACIENDA DE GUADALUPE', '0175', 'COLONIA', '74200'),
  ('LA HERRADURA', '0175', 'COLONIA', '74200'),
  ('LA PURISIMA', '0175', 'COLONIA', '74200'),
  ('LOS PINOS', '0175', 'COLONIA', '74200'),
  ('NUEVA ESPA√ëA', '0175', 'COLONIA', '74200'),
  ('NUEVA GENERACION', '0175', 'COLONIA', '74200'),
  ('PRADOS GUADALUPE', '0175', 'COLONIA', '74200'),
  ('RINCON GUADALUPE', '0175', 'COLONIA', '74200'),
  ('SAN JOSE ACTIPAN', '0175', 'PUEBLO', '74200'),
  ('TLALTECAHUACAN', '0175', 'COLONIA', '74200'),
  ('VILLAS DE GUADALUPE', '0175', 'COLONIA', '74200'),
  ('AGUA DULCE', '0176', 'COLONIA', '74200'),
  ('CERRO DE LA CANTERA', '0176', 'COLONIA', '74200'),
  ('COLINAS DE GUADALUPE', '0176', 'COLONIA', '74200'),
  ('EL LIMONERO', '0176', 'COLONIA', '74200'),
  ('EL POTRERO', '0176', 'COLONIA', '74200'),
  ('FRACCIONAMIENTO SAN LUIS', '0176', 'FRACCIONAMIENTO', '74200'),
  ('GUADALUPE', '0176', 'COLONIA', '74200'),
  ('HACIENDA VIEJA', '0176', 'COLONIA', '74200'),
  ('LA JOYA', '0176', 'COLONIA', '74200'),
  ('LAS GRANJAS', '0176', 'COLONIA', '74200'),
  ('LOS ENCINOS', '0176', 'COLONIA', '74200'),
  ('RANCHO BONITO', '0176', 'COLONIA', '74200'),
  ('SAN ANDRES ATLIXCO', '0176', 'PUEBLO', '74200'),
  ('SAN LUIS', '0176', 'COLONIA', '74200'),
  ('VILLAS DE GUADALUPE', '0176', 'COLONIA', '74200'),
  ('EL CAPULIN', '0177', 'RANCHO', '74200'),
  ('EL RECREO', '0177', 'COLONIA', '74200'),
  ('EMILIANO ZAPATA', '0177', 'COLONIA', '74200'),
  ('LA LOMA', '0177', 'COLONIA', '74200'),
  ('LAS PALMAS', '0177', 'COLONIA', '74200'),
  ('RINCON DE GUADALUPE', '0177', 'COLONIA', '74200'),
  ('SAN JOSE TERUEL', '0177', 'COLONIA', '74200'),
  ('VILLA LAS MARGARITAS', '0177', 'COLONIA', '74200'),
  ('BOSQUES DE AHUATEPEC', '0178', 'FRACCIONAMIENTO', '74260'),
  ('EL POTRERO', '0178', 'COLONIA', '74260'),
  ('GRANJAS AHUATEPEC', '0178', 'FRACCIONAMIENTO', '74260'),
  ('HACIENDA DE AHUATEPEC', '0178', 'FRACCIONAMIENTO', '74260'),
  ('LA LOMA', '0178', 'COLONIA', '74260'),
  ('RANCHO EL CEJO', '0178', 'RANCHO', '74260'),
  ('SANTA MARIA AHUATEPEC', '0178', 'PUEBLO', '74260'),
  ('VILLAS DE AHUATEPEC', '0178', 'FRACCIONAMIENTO', '74260'),
  ('EL MAGUEYITO', '0179', 'COLONIA', '74260'),
  ('LA CONCEPCION', '0179', 'COLONIA', '74260'),
  ('LA PALMA', '0179', 'COLONIA', '74260'),
  ('LAS DALIAS', '0179', 'COLONIA', '74260'),
  ('PRADOS DEL SOL', '0179', 'FRACCIONAMIENTO', '74260'),
  ('SAN ANDRES CALPAN', '0179', 'PUEBLO', '74260'),
  ('VILLA DEL REY', '0179', 'FRACCIONAMIENTO', '74260'),
  ('EL PEDRAL', '0180', 'COLONIA', '74260'),
  ('LA NORIA', '0180', 'COLONIA', '74260'),
  ('LA PRESA', '0180', 'COLONIA', '74260'),
  ('LAS GRANJAS', '0180', 'COLONIA', '74260'),
  ('LOS PINOS', '0180', 'COLONIA', '74260'),
  ('MOLINO BLANCO', '0180', 'COLONIA', '74260'),
  ('RANCHO EL CHINGO', '0180', 'RANCHO', '74260'),
  ('SAN DIEGO CHALMA', '0180', 'PUEBLO', '74260'),
  ('TEPETITLA', '0180', 'PUEBLO', '74260'),
  ('XOCHITEPEC', '0180', 'PUEBLO', '74260'),
  ('EL TEPETATE', '0181', 'COLONIA', '74260'),
  ('GRANJAS BELEM', '0181', 'FRACCIONAMIENTO', '74260'),
  ('LA BARCA', '0181', 'COLONIA', '74260'),
  ('LA CONCEPCION', '0181', 'COLONIA', '74260'),
  ('LOS ARCOS', '0181', 'COLONIA', '74260'),
  ('PARA√çSO ATLIXCO', '0181', 'FRACCIONAMIENTO', '74260'),
  ('SAN DIEGO CHALMA', '0181', 'PUEBLO', '74260'),
  ('TLALTECAHUACAN', '0181', 'COLONIA', '74260'),
  ('VILLA CHALMA', '0181', 'COLONIA', '74260'),
  ('VISTA DEL PARQUE', '0181', 'FRACCIONAMIENTO', '74260'),
  ('EL CERRITO', '0182', 'COLONIA', '74260'),
  ('EL VERDE', '0182', 'COLONIA', '74260'),
  ('FRACCIONAMIENTO PARA√çSO', '0182', 'FRACCIONAMIENTO', '74260'),
  ('LA RINCONADA', '0182', 'COLONIA', '74260'),
  ('LAS GRANJAS', '0182', 'COLONIA', '74260'),
  ('LOMAS DEL SOL', '0182', 'COLONIA', '74260'),
  ('RANCHO EL AGUAJE', '0182', 'RANCHO', '74260'),
  ('SAN CRISTOBAL COYULA', '0182', 'PUEBLO', '74260'),
  ('VILLAS DEL CAMPO', '0182', 'FRACCIONAMIENTO', '74260'),
  ('EL PE√ëON', '0183', 'COLONIA', '74260'),
  ('LA CANTERA', '0183', 'COLONIA', '74260'),
  ('LA JOYA', '0183', 'COLONIA', '74260'),
  ('LOS FRESNOS', '0183', 'FRACCIONAMIENTO', '74260'),
  ('RANCHO LA PALMA', '0183', 'RANCHO', '74260'),
  ('SAN CRISTOBAL COYULA', '0183', 'PUEBLO', '74260'),
  ('SAN DIEGO', '0183', 'COLONIA', '74260'),
  ('VILLAS DEL CAMPO', '0183', 'FRACCIONAMIENTO', '74260'),
  ('EL CALVARIO', '0184', 'COLONIA', '74360'),
  ('EL RECODO', '0184', 'COLONIA', '74360'),
  ('GRANJAS DE ATLIXCO', '0184', 'FRACCIONAMIENTO', '74360'),
  ('LA ESPERANZA', '0184', 'COLONIA', '74360'),
  ('LAS GRANJAS', '0184', 'COLONIA', '74360'),
  ('MONTE ALEGRE', '0184', 'COLONIA', '74360'),
  ('NUEVA CREACION', '0184', 'COLONIA', '74360'),
  ('RANCHO LA CA√ëADA', '0184', 'RANCHO', '74360'),
  ('SAN AGUSTIN ATZOMPA', '0184', 'PUEBLO', '74360'),
  ('SAN JUAN TIANGUISMANALCO', '0184', 'PUEBLO', '74360'),
  ('VILLA LAS AMERICAS', '0184', 'COLONIA', '74360'),
  ('EL CARRIZAL', '0185', 'COLONIA', '74360'),
  ('EL PORVENIR', '0185', 'COLONIA', '74360'),
  ('LA HACIENDA', '0185', 'COLONIA', '74360'),
  ('LAS FUENTES', '0185', 'COLONIA', '74360'),
  ('RANCHO EL CAPULIN', '0185', 'RANCHO', '74360'),
  ('SAN JUAN TIANGUISMANALCO', '0185', 'PUEBLO', '74360'),
  ('SAN MARCOS', '0185', 'COLONIA', '74360'),
  ('SANTA CRUZ', '0185', 'COLONIA', '74360'),
  ('VILLAS DEL CAMPO', '0185', 'COLONIA', '74360'),
  ('ACATL√ÅN DE OSORIO', '0186', 'COLONIA', '74200'),
  ('EL FRESNO', '0186', 'COLONIA', '74200'),
  ('EL MIRADOR', '0186', 'COLONIA', '74200'),
  ('EL TEXCAL', '0186', 'COLONIA', '74200'),
  ('GRANJAS DEL CAMPO', '0186', 'FRACCIONAMIENTO', '74200'),
  ('LA CIENEGA', '0186', 'COLONIA', '74200'),
  ('LA JOYA', '0186', 'COLONIA', '74200'),
  ('RANCHO EL TEXCAL', '0186', 'RANCHO', '74200'),
  ('SAN ANTONIO ATZALA', '0186', 'PUEBLO', '74200'),
  ('SAN PEDRO ATLIXCO', '0186', 'PUEBLO', '74200'),
  ('SAN RAFAEL', '0186', 'COLONIA', '74200'),
  ('TEPEYAC', '0186', 'COLONIA', '74200'),
  ('XOCHITLAN ATLIXCO', '0186', 'PUEBLO', '74200'),
  ('EL COYOL', '0187', 'COLONIA', '74200'),
  ('EL NARANJO', '0187', 'COLONIA', '74200'),
  ('EL SALADO', '0187', 'COLONIA', '74200'),
  ('GRANJAS EL NARANJO', '0187', 'FRACCIONAMIENTO', '74200'),
  ('LA FINCA', '0187', 'COLONIA', '74200'),
  ('LA JOYA', '0187', 'COLONIA', '74200'),
  ('LAS ROSAS', '0187', 'COLONIA', '74200'),
  ('LOS PINOS', '0187', 'COLONIA', '74200'),
  ('SAN ANTONIO ATZALA', '0187', 'PUEBLO', '74200'),
  ('SAN JUAN PUEBLO', '0187', 'PUEBLO', '74200'),
  ('VILLAS CAMPESTRES', '0187', 'FRACCIONAMIENTO', '74200'),
  ('EL LAUREL', '0188', 'COLONIA', '74200'),
  ('LA CONCEPCION', '0188', 'COLONIA', '74200'),
  ('LA JOYA', '0188', 'COLONIA', '74200'),
  ('RANCHO EL MIRADOR', '0188', 'RANCHO', '74200'),
  ('SAN BARTOLOME ATLIXCO', '0188', 'PUEBLO', '74200'),
  ('SAN PABLO DEL MONTE', '0188', 'PUEBLO', '74200'),
  ('SAN PEDRO ATLIXCO', '0188', 'PUEBLO', '74200'),
  ('TEPEYAC', '0188', 'COLONIA', '74200'),
  ('VILLAS DEL CAMPO', '0188', 'COLONIA', '74200'),
  ('EL SAUCILLO', '0189', 'COLONIA', '74200'),
  ('GRANJAS DE TEPETITLA', '0189', 'FRACCIONAMIENTO', '74200'),
  ('LA COMPANIA', '0189', 'PUEBLO', '74200'),
  ('LA JOYA', '0189', 'COLONIA', '74200'),
  ('LA SOLEDAD', '0189', 'COLONIA', '74200'),
  ('RANCHO VERDE', '0189', 'RANCHO', '74200'),
  ('SAN BARTOLOME ATLIXCO', '0189', 'PUEBLO', '74200'),
  ('SANTA TERESA', '0189', 'COLONIA', '74200'),
  ('TEPETITLA', '0189', 'PUEBLO', '74200'),
  ('VILLA DEL CAMPO', '0189', 'COLONIA', '74200'),
  ('EL CALVARIO', '0190', 'COLONIA', '74215'),
  ('EL MIRADOR', '0190', 'COLONIA', '74215'),
  ('LA ESPERANZA', '0190', 'COLONIA', '74215'),
  ('LA MAGDALENA', '0190', 'COLONIA', '74215'),
  ('LOS PINOS', '0190', 'COLONIA', '74215'),
  ('RANCHO LA MAGDALENA', '0190', 'RANCHO', '74215'),
  ('SAN ANDRES HUEYAPAN', '0190', 'PUEBLO', '74215'),
  ('SAN JUAN TEJALUCA', '0190', 'PUEBLO', '74215'),
  ('SAN LUCAS ATZALA', '0190', 'PUEBLO', '74215'),
  ('TEPEYAC', '0190', 'COLONIA', '74215'),
  ('VILLA LAS FLORES', '0190', 'COLONIA', '74215'),
  ('EL POTRERO', '0191', 'COLONIA', '74215'),
  ('EL TEJOCOTE', '0191', 'COLONIA', '74215'),
  ('GRANJAS DEL TEJOCOTE', '0191', 'FRACCIONAMIENTO', '74215'),
  ('LA CONCEPCION', '0191', 'COLONIA', '74215'),
  ('LA LOMA', '0191', 'COLONIA', '74215'),
  ('RANCHO EL POTRERO', '0191', 'RANCHO', '74215'),
  ('SAN ANDRES HUEYAPAN', '0191', 'PUEBLO', '74215'),
  ('TEPEYAC', '0191', 'COLONIA', '74215'),
  ('VILLAS DE SAN ANDRES', '0191', 'FRACCIONAMIENTO', '74215'),
  ('EL BORDO', '0192', 'COLONIA', '74215'),
  ('EL CERRITO', '0192', 'COLONIA', '74215'),
  ('EL ROSARIO', '0192', 'COLONIA', '74215'),
  ('GUADALUPE', '0192', 'COLONIA', '74215'),
  ('LA JOYA', '0192', 'COLONIA', '74215'),
  ('RANCHO EL BORDO', '0192', 'RANCHO', '74215'),
  ('SAN ANDRES HUEYAPAN', '0192', 'PUEBLO', '74215'),
  ('TEPEYAC', '0192', 'COLONIA', '74215'),
  ('EL PALMAR', '0193', 'COLONIA', '74215'),
  ('EL PENON', '0193', 'COLONIA', '74215'),
  ('LA JOYA', '0193', 'COLONIA', '74215'),
  ('RANCHO LAS JOYAS', '0193', 'RANCHO', '74215'),
  ('SANTA CRUZ HUAXCO', '0193', 'PUEBLO', '74215'),
  ('TEPEYAC', '0193', 'COLONIA', '74215'),
  ('VILLAS DEL CAMPO', '0193', 'COLONIA', '74215'),
  ('EL MOLINO', '0194', 'COLONIA', '74215'),
  ('LA CIENEGA', '0194', 'COLONIA', '74215'),
  ('LA LOMA', '0194', 'COLONIA', '74215'),
  ('RANCHO EL MOLINO', '0194', 'RANCHO', '74215'),
  ('SAN ANDRES HUEYAPAN', '0194', 'PUEBLO', '74215'),
  ('SAN NICOLAS TOLENTINO', '0194', 'PUEBLO', '74215'),
  ('TEPEYAC', '0194', 'COLONIA', '74215'),
  ('TULIMAN', '0194', 'PUEBLO', '74215'),
  ('EL AGUACATE', '0195', 'COLONIA', '74368'),
  ('EL BORDO', '0195', 'COLONIA', '74368'),
  ('EL ORGANO', '0195', 'RANCHO', '74368'),
  ('LA PALMA', '0195', 'RANCHO', '74368'),
  ('RANCHO EL AGUACATE', '0195', 'RANCHO', '74368'),
  ('SAN JERONIMO TIANGUISMANALCO', '0195', 'PUEBLO', '74368'),
  ('EL RINCON', '0196', 'COLONIA', '74368'),
  ('LA CA√ëADA', '0196', 'COLONIA', '74368'),
  ('RANCHO EL COYOTE', '0196', 'RANCHO', '74368'),
  ('SAN DIEGO BUENAVISTA', '0196', 'PUEBLO', '74368'),
  ('SAN FELIX TLALPA', '0196', 'PUEBLO', '74368'),
  ('TEPEYAC', '0196', 'COLONIA', '74368'),
  ('EL CAPULIN', '0197', 'COLONIA', '74368'),
  ('EL MAGUEY', '0197', 'COLONIA', '74368'),
  ('EL SAUCILLO', '0197', 'COLONIA', '74368'),
  ('LA GUADALUPE', '0197', 'COLONIA', '74368'),
  ('LA JOYA', '0197', 'COLONIA', '74368'),
  ('RANCHO EL MEZQUITE', '0197', 'RANCHO', '74368'),
  ('SAN BALTAZAR TETELA', '0197', 'PUEBLO', '74368'),
  ('SAN DIEGO BUENAVISTA', '0197', 'PUEBLO', '74368'),
  ('EL AGUAJE', '0198', 'COLONIA', '74368'),
  ('EL BORDITO', '0198', 'COLONIA', '74368'),
  ('LA PALMA', '0198', 'COLONIA', '74368'),
  ('RANCHO EL AGUAJE', '0198', 'RANCHO', '74368'),
  ('SAN BALTAZAR TETELA', '0198', 'PUEBLO', '74368'),
  ('TEPEYAC', '0198', 'COLONIA', '74368'),
  ('EL CERRITO', '0199', 'COLONIA', '74368'),
  ('EL LIMON', '0199', 'COLONIA', '74368'),
  ('RANCHO EL LIMON', '0199', 'RANCHO', '74368'),
  ('SAN ANDRES CHOLULA', '0199', 'PUEBLO', '74368'),
  ('SAN DIEGO BUENAVISTA', '0199', 'PUEBLO', '74368'),
  ('TEPEYAC', '0199', 'COLONIA', '74368'),
  ('EL GUAYABO', '0200', 'COLONIA', '74368'),
  ('EL SAUCILLO', '0200', 'COLONIA', '74368'),
  ('LA CA√ëADA', '0200', 'COLONIA', '74368'),
  ('RANCHO EL GUAYABO', '0200', 'RANCHO', '74368'),
  ('SAN ANTONIO ALPANOCAN', '0200', 'PUEBLO', '74368'),
  ('SAN JUAN BUENAVISTA', '0200', 'PUEBLO', '74368'),
  ('TEPEYAC', '0200', 'COLONIA', '74368'),
  ('EL AGUAJE', '0201', 'COLONIA', '74368'),
  ('EL CARMEN', '0201', 'COLONIA', '74368'),
  ('EL MIRADOR', '0201', 'COLONIA', '74368'),
  ('EL SAUCILLO', '0201', 'COLONIA', '74368'),
  ('LA LAGUNILLA', '0201', 'COLONIA', '74368'),
  ('RANCHO EL VENADILLO', '0201', 'RANCHO', '74368'),
  ('SAN ANDRES HUEYAPAN', '0201', 'PUEBLO', '74368'),
  ('SAN ANTONIO ALPANOCAN', '0201', 'PUEBLO', '74368'),
  ('TEPEYAC', '0201', 'COLONIA', '74368'),
  ('EL AGUAJITO', '0202', 'COLONIA', '74368'),
  ('EL PALMAR', '0202', 'COLONIA', '74368'),
  ('LA GUADALUPANA', '0202', 'COLONIA', '74368'),
  ('RANCHO EL PALMAR', '0202', 'RANCHO', '74368'),
  ('SAN ANDRES CALPAN', '0202', 'PUEBLO', '74368'),
  ('SANTA ISABEL CHALMA', '0202', 'PUEBLO', '74368'),
  ('TEPEYAC', '0202', 'COLONIA', '74368'),
  ('EL JIOTE', '0203', 'COLONIA', '74368'),
  ('EL TIGRE', '0203', 'RANCHO', '74368'),
  ('HUITZAPULA', '0203', 'PUEBLO', '74368'),
  ('RANCHO EL JIOTE', '0203', 'RANCHO', '74368'),
  ('SANTA CRUZ ALPANOCAN', '0203', 'PUEBLO', '74368'),
  ('SANTO TOMAS CHAUTLA', '0203', 'PUEBLO', '74368'),
  ('TEPEYAC', '0203', 'COLONIA', '74368'),
  ('EL CAPULIN', '0204', 'COLONIA', '74368'),
  ('EL RINCON', '0204', 'COLONIA', '74368'),
  ('RANCHO BONITO', '0204', 'RANCHO', '74368'),
  ('SANTA ANA COATEPEC', '0204', 'PUEBLO', '74368'),
  ('SANTA CRUZ ALPANOCAN', '0204', 'PUEBLO', '74368'),
  ('TEPEYAC', '0204', 'COLONIA', '74368'),
  ('EL ENCANTO', '0205', 'COLONIA', '74360'),
  ('EL POTRERO', '0205', 'RANCHO', '74360'),
  ('LA LAGUNA', '0205', 'COLONIA', '74360'),
  ('RANCHO EL ENCANTO', '0205', 'RANCHO', '74360'),
  ('SAN ANTONIO ALPANOCAN', '0205', 'PUEBLO', '74360'),
  ('SAN MARCOS TLALANCALECA', '0205', 'PUEBLO', '74360'),
  ('TEPEYAC', '0205', 'COLONIA', '74360'),
  ('EL AGUAJE', '0206', 'COLONIA', '74360'),
  ('EL MAGUEY', '0206', 'COLONIA', '74360'),
  ('EL VENADILLO', '0206', 'COLONIA', '74360'),
  ('RANCHO EL MAGUEY', '0206', 'RANCHO', '74360'),
  ('SANTA CRUZ TLALANCALECA', '0206', 'PUEBLO', '74360'),
  ('TEPEYAC', '0206', 'COLONIA', '74360'),
  ('EL ARENAL', '0207', 'COLONIA', '74360'),
  ('EL BORDO', '0207', 'COLONIA', '74360'),
  ('EL ENCINO', '0207', 'COLONIA', '74360'),
  ('LA CA√ëADA', '0207', 'COLONIA', '74360'),
  ('RANCHO EL ARENAL', '0207', 'RANCHO', '74360'),
  ('SAN ANDRES TLALANCALECA', '0207', 'PUEBLO', '74360'),
  ('TEPEYAC', '0207', 'COLONIA', '74360'),
  ('ATZALA', '0208', 'PUEBLO', '74360'),
  ('EL PE√ëON', '0208', 'COLONIA', '74360'),
  ('LA JOYA', '0208', 'COLONIA', '74360'),
  ('RANCHO EL PE√ëON', '0208', 'RANCHO', '74360'),
  ('SAN ANDRES CALPAN', '0208', 'PUEBLO', '74360'),
  ('TEPEYAC', '0208', 'COLONIA', '74360'),
  ('EL TIGRE', '0209', 'COLONIA', '74360'),
  ('GRANJAS EL TIGRE', '0209', 'FRACCIONAMIENTO', '74360'),
  ('LA BARRANCA', '0209', 'COLONIA', '74360'),
  ('RANCHO EL TIGRE', '0209', 'RANCHO', '74360'),
  ('SAN ANDRES CALPAN', '0209', 'PUEBLO', '74360'),
  ('TEPEYAC', '0209', 'COLONIA', '74360'),
  ('EL POTRERO', '0210', 'COLONIA', '74360'),
  ('LA PALMA', '0210', 'COLONIA', '74360'),
  ('RANCHO LA PALMA', '0210', 'RANCHO', '74360'),
  ('SAN ANDRES CALPAN', '0210', 'PUEBLO', '74360'),
  ('TEPEYAC', '0210', 'COLONIA', '74360'),
  ('EL CAPULIN', '0211', 'COLONIA', '74360'),
  ('EL MAGUEYITO', '0211', 'COLONIA', '74360'),
  ('GRANJAS DEL CAMPO', '0211', 'FRACCIONAMIENTO', '74360'),
  ('LA PALMA', '0211', 'COLONIA', '74360'),
  ('RANCHO EL CAPULIN', '0211', 'RANCHO', '74360'),
  ('SAN AGUSTIN ATZOMPA', '0211', 'PUEBLO', '74360'),
  ('SAN ANDRES CALPAN', '0211', 'PUEBLO', '74360'),
  ('TEPEYAC', '0211', 'COLONIA', '74360'),
  ('EL AGUAJITO', '0212', 'COLONIA', '74368'),
  ('EL ENCINO', '0212', 'COLONIA', '74368'),
  ('EL MAGUEYITO', '0212', 'COLONIA', '74368'),
  ('EL RECODO', '0212', 'COLONIA', '74368'),
  ('GRANJAS DEL CAMPO', '0212', 'FRACCIONAMIENTO', '74368'),
  ('LA PALMA', '0212', 'COLONIA', '74368'),
  ('SAN ANDRES CALPAN', '0212', 'PUEBLO', '74368'),
  ('SANTA CRUZ', '0212', 'COLONIA', '74368'),
  ('TEPEYAC', '0212', 'COLONIA', '74368'),
  ('EL AGUAJE', '0213', 'COLONIA', '74368'),
  ('EL MEZQUITE', '0213', 'COLONIA', '74368'),
  ('EL RINCON', '0213', 'COLONIA', '74368'),
  ('LA JOYA', '0213', 'COLONIA', '74368'),
  ('RANCHO EL AGUAJE', '0213', 'RANCHO', '74368'),
  ('SAN ANDRES CALPAN', '0213', 'PUEBLO', '74368'),
  ('TEPEYAC', '0213', 'COLONIA', '74368'),
  ('ATZOMPA', '0214', 'PUEBLO', '74360'),
  ('EL AGUAJITO', '0214', 'COLONIA', '74360'),
  ('LA PALOMA', '0214', 'COLONIA', '74360'),
  ('RANCHO LA PALOMA', '0214', 'RANCHO', '74360'),
  ('SAN AGUSTIN ATZOMPA', '0214', 'PUEBLO', '74360'),
  ('TEPEYAC', '0214', 'COLONIA', '74360'),
  ('EL ARENAL', '0215', 'COLONIA', '74368'),
  ('EL MEZQUITE', '0215', 'COLONIA', '74368'),
  ('LA LOMA', '0215', 'COLONIA', '74368'),
  ('RANCHO EL ARENAL', '0215', 'RANCHO', '74368'),
  ('SAN ANTONIO ATZALA', '0215', 'PUEBLO', '74368'),
  ('SAN JERONIMO CALERAS', '0215', 'PUEBLO', '74368'),
  ('TEPEYAC', '0215', 'COLONIA', '74368'),
  ('CUESCOMATE', '0216', 'COLONIA', '74368'),
  ('EL MAGUEY', '0216', 'COLONIA', '74368'),
  ('FRACCIONAMIENTO SAN JUAN', '0216', 'FRACCIONAMIENTO', '74368'),
  ('LA HACIENDA', '0216', 'COLONIA', '74368'),
  ('LOMAS DE TEJALUCA', '0216', 'COLONIA', '74368'),
  ('LOS PINOS', '0216', 'RANCHO', '74368'),
  ('RANCHO EL GENERAL', '0216', 'COLONIA', '74368'),
  ('SAN ALFONSO', '0216', 'COLONIA', '74215'),
  ('SAN JUAN TEJALUCA', '0216', 'PUEBLO', '74360'),
  ('EX-HACIENDA           CASCO MAURER', '0217', 'HACIENDA', '74368'),
  ('EL FRESNO', '0217', 'FRACCIONAMIENTO', '74368'),
  ('EMILIANO ZAPATA (NEJATENGO)', '0217', 'PUEBLO', '74368'),
  ('FLORISOL', '0217', 'RANCHO', '74368'),
  ('RANCHO EL PUENTE', '0217', 'COLONIA', '74368'),
  ('SANTA ANA YANCUITLALPAN', '0217', 'PUEBLO', '74368'),
  ('SANTA ELENA', '0217', 'RANCHO', '74368'),
  ('EX-HACIENDA             CASCO SANTA LUCIA', '0218', 'HACIENDA', '74368'),
  ('SANTA LUCIA COSAMALOAPAN', '0218', 'PUEBLO', '74368'),
  ('EJIDO RICARDO FLORES MAGON', '0219', 'COLONIA', '74368'),
  ('PBLO EL RECREO XONACA', '0219', 'PUEBLO', '74368'),
  ('SAN FELIX ALMAZAN', '0219', 'PUEBLO', '74368'),
  ('SAN ISIDRO', '0219', 'RANCHO', '74368'),
  ('SAN ISIDRO HUILOTEPEC', '0219', 'PUEBLO', '74368'),
  ('SANTA CECILIA YANCUITLALPAN', '0219', 'COLONIA', '74368'),
  ('EX-HACIENDA             CASCO OTILIO MONTA√ëO', '0220', 'HACIENDA', '74368'),
  ('JUAN UVERA', '0220', 'PUEBLO', '74368'),
  ('LA JOYA', '0220', 'FRACCIONAMIENTO', '74368'),
  ('OTILIO MONTA√ëO', '0220', 'PUEBLO', '74369'),
  ('SAN ESTEBAN ZOAPILTEPEC', '0221', 'PUEBLO', '74369'),
  ('SAN FELIPE XONACAYUCAN', '0221', 'PUEBLO', '74369'),
  ('SAN JERONIMO CALERAS', '0221', 'PUEBLO', '74369')
ON CONFLICT (nombre, seccion_id) DO NOTHING;

-- ============================================================
-- PASO 3: ASIGNAR municipio_id V√çA JOIN CON SECCIONES
-- ============================================================
UPDATE colonias co
  SET municipio_id = se.municipio_id
  FROM secciones_electorales se
  WHERE co.seccion_id = se.seccion
    AND co.municipio_id IS NULL;

-- ============================================================
-- PASO 4: FALLBACK ‚Äî Atlixco (id=1) para cualquier hu√©rfano
-- (secciones 0154-0221 pertenecen todas a Atlixco)
-- ============================================================
UPDATE colonias
  SET municipio_id = 1
  WHERE municipio_id IS NULL
    AND seccion_id BETWEEN '0154' AND '0221';

-- ============================================================
-- PASO 5: RE-AGREGAR NOT NULL
-- ============================================================
ALTER TABLE colonias ALTER COLUMN municipio_id SET NOT NULL;

-- ============================================================
-- PASO 6: VALIDACI√ìN FINAL
-- ============================================================
DO $$
DECLARE
  v_total    INT;
  v_activas  INT;
  v_sin_mun  INT;
BEGIN
  SELECT COUNT(*) INTO v_total   FROM colonias;
  SELECT COUNT(*) INTO v_activas FROM colonias WHERE municipio_id = 1 AND activa = true;
  SELECT COUNT(*) INTO v_sin_mun FROM colonias WHERE municipio_id IS NULL;

  RAISE NOTICE '========================================';
  RAISE NOTICE 'FIX COLONIAS COMPLETADO';
  RAISE NOTICE '========================================';
  RAISE NOTICE 'Total colonias: %', v_total;
  RAISE NOTICE 'Colonias activas en Atlixco: %', v_activas;
  RAISE NOTICE 'Colonias sin municipio (debe ser 0): %', v_sin_mun;

  IF v_sin_mun > 0 THEN
    RAISE EXCEPTION '‚ùå FALLO: Quedaron % colonias sin municipio_id. Revisar secciones_electorales.', v_sin_mun;
  END IF;

  IF v_activas < 400 THEN
    RAISE WARNING '‚ö†Ô∏è  Solo % colonias activas en Atlixco (esperadas ‚â•400). Verificar datos.', v_activas;
  ELSE
    RAISE NOTICE '‚úÖ Todo correcto. El formulario de encuesta deber√≠a mostrar las colonias.';
  END IF;
END $$;

-- ============================================================
-- FIN FIX COLONIAS
-- ============================================================
